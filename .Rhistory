info_tda_1 <- Walmart[Walmart$Store == '1',];info_tda_1
modets <- ts(info_tda_1$Weekly_Sales,start = decimal_date(as.Date("2010-02-05")), frequency = 52); #Actualizacion de inicio y Frecuencia#
#Gráfica
ts.plot(modets)
qqline(mean(modets), col="Red", lwd=2)
#Media Móvil
Prom_Movil_2 <- movavg(modets,2,type="s"); Prom_Movil_2
ts.plot(modets,Prom_Movil_2,xlab=NULL,ylab=NULL, main = "Pronóstico de Promedio Movil",lty=c(1:2),lwd =c(1,1.5) ,col=c(1,2))
legend(x="bottomright",legend=c("Obs","Prom Movil"),col=c(1,2),lty=c(1,2))
#Errores
mae <- MAE(modets,Prom_Movil_2);mae
mape <- MAPE(modets,Prom_Movil_2); mape
smape <- SMAPE(modets,Prom_Movil_2); smape
mse <- MSE(modets,Prom_Movil_2); mse
rmse <- RMSE(modets,Prom_Movil_2); rmse
medidas <- matrix(c(mae,mape,smape,mse,rmse)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Simple")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Promedio Movil ")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y)
f<-rep(0,144)
for (t in 3:144) f[t]<-(0.75)*y[t-1]+(0.25)*y[t-2]
f <- ts(f, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,f,xlab=NULL,ylab=NULL, main = "Pronóstico de Promedio Ponderado",lty=c(1:2),lwd =c(1,1.5) ,col=c(1,2))
legend(x="bottomright",legend=c("Obs","Promedio Ponderado"),col=c(1,2),lty=c(1,2))
yp_ob<-rep(0,141)
for (t in 1:141) yp_ob[t]<-y[t+2]
yp_pr<-rep(0,141)
for (t in 1:141) yp_pr[t]<-f[t+2]
mae_yp<-MAE(yp_ob,yp_pr);mae_yp
mape_yp<-MAPE(yp_ob,yp_pr);mape_yp
smape_yp<-SMAPE(yp_ob,yp_pr)
mse_yp<-MSE(yp_ob,yp_pr)
rmse_yp<-RMSE(yp_ob,yp_pr)
medidas <- matrix(c(mae_yp,mape_yp,smape_yp,mse_yp,rmse_yp)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Promedio Ponderado")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Promedio Ponderado")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#----------------------------------------------------------------------------------------------------------------------------#
#meda movil w
library(pracma)
fw<-movavg(y,2,type="w")
fwt<-rep(0,143)
for(t in 2:143) fwt[t]<-fw[t-1]
for(t in 1) fwt[t]<-NA
fw_ts<-rep(0,143)
fw_ts<-ts(fwt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fw_ts,xlab=NULL,ylab=NULL, main = "Media Móvil w",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovP"),col=c(1,2),lty=c(1,2))
#
yw_ob<-rep(0,142)
for (t in 1:142) yw_ob[t]<-y[t+1]
yw_pr<-rep(0,142)
for (t in 1:142) yw_pr[t]<-fw[t]
mae_yw<-MAE(yw_ob,yw_pr)
mape_yw<-MAPE(yw_ob,yw_pr)
smape_yw<-SMAPE(yw_ob,yw_pr)
mse_yw<-MSE(yw_ob,yw_pr)
rmse_yw<-RMSE(yw_ob,yw_pr)
medidas <- matrix(c(mae_yw,mape_yw,smape_yw,mse_yw,rmse_yw)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Movilw")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.Movilw")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#meda movil e
library(pracma)
fe<-movavg(y,2,type="e")
fet<-rep(0,143)
for(t in 2:143) fet[t]<-fe[t-1]
for(t in 1) fet[t]<-NA
fe_ts<-rep(0,143)
fe_ts<-ts(fet,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fe_ts,xlab=NULL,ylab=NULL, main = "Media Móvil e",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovP"),col=c(1,2),lty=c(1,2))
#
ye_ob<-rep(0,142)
for (t in 1:142) ye_ob[t]<-y[t+1]
ye_pr<-rep(0,142)
for (t in 1:142) ye_pr[t]<-fe[t]
mae_ye<-MAE(ye_ob,ye_pr)
mape_ye<-MAPE(ye_ob,ye_pr)
smape_ye<-SMAPE(ye_ob,ye_pr)
mse_ye<-MSE(ye_ob,ye_pr)
rmse_ye<-RMSE(ye_ob,ye_pr)
medidas <- matrix(c(mae_ye,mape_ye,smape_ye,mse_ye,rmse_ye)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Movile")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.Movile")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#----------------------------------------------------------------------------------------------------------------------------#
#meda movil r
library(pracma)
fr<-movavg(y,2,type="r")
frt<-rep(0,143)
for(t in 2:143) frt[t]<-fr[t-1]
for(t in 1) frt[t]<-NA
fr_ts<-rep(0,143)
fr_ts<-ts(frt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fr_ts,xlab=NULL,ylab=NULL, main = "Media Móvil r",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovP"),col=c(1,2),lty=c(1,2))
#
yr_ob<-rep(0,142)
for (t in 1:142) yr_ob[t]<-y[t+1]
yr_pr<-rep(0,142)
for (t in 1:142) yr_pr[t]<-fr[t]
mae_yr<-MAE(yr_ob,yr_pr)
mape_yr<-MAPE(yr_ob,yr_pr)
smape_yr<-SMAPE(yr_ob,yr_pr)
mse_yr<-MSE(yr_ob,yr_pr)
rmse_yr<-RMSE(yr_ob,yr_pr)
medidas <- matrix(c(mae_yr,mape_yr,smape_yr,mse_yr,rmse_yr)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.MovilR")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.MovilR")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
m1<-movavg(y, 2, type=c("s"))
m2<-movavg(m1,2, type=c("s"))
b<-(2/1)*(m1-m2)
a = 2*m1-m2
f<-a+b*1
#Grafica
fdt<-rep(0,144)
for(t in 2:144) fdt[t]<-f[t-1]
for(t in 1) fdt[t]<-NA
fd_ts<-rep(0,144)
fd_ts<-ts(fdt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fd_ts,xlab=NULL,ylab=NULL, main = "Media Móvil Doble",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovD"),col=c(1,2),lty=c(1,2))
#Errores
yd_pr<-rep(0,143)
for (t in 1:143) yd_pr[t]<-f[t]
mae_yd<-MAE(y,yd_pr)
mape_yd<-MAPE(y,yd_pr)
smape_yd<-SMAPE(y,yd_pr)
mse_yd<-MSE(y,yd_pr)
rmse_yd<-RMSE(y,yd_pr)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Movil doble")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.Movil doble")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
m1<-movavg(y, 2, type=c("t"))
m2<-movavg(m1,2, type=c("t"))
b<-(2/1)*(m1-m2)
a = 2*m1-m2
f<-a+b*1
#Grafica
fdt<-rep(0,144)
for(t in 2:144) fdt[t]<-f[t-1]
for(t in 1) fdt[t]<-NA
fd_ts<-rep(0,144)
fd_ts<-ts(fdt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fd_ts,xlab=NULL,ylab=NULL, main = "Media Móvil Doble Triangular",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovD"),col=c(1,2),lty=c(1,2))
#Errores
yd_pr<-rep(0,143)
for (t in 1:143) yd_pr[t]<-f[t]
mae_yd<-MAE(y,yd_pr)
mape_yd<-MAPE(y,yd_pr)
smape_yd<-SMAPE(y,yd_pr)
mse_yd<-MSE(y,yd_pr)
rmse_yd<-RMSE(y,yd_pr)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Movil doble Triangular")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.Movil doble Triangular")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
m1<-movavg(y, 2, type=c("m"))
m2<-movavg(m1,2, type=c("m"))
b<-(2/1)*(m1-m2)
a = 2*m1-m2
f<-a+b*1
#Grafica
fdt<-rep(0,144)
for(t in 2:144) fdt[t]<-f[t-1]
for(t in 1) fdt[t]<-NA
fd_ts<-rep(0,144)
fd_ts<-ts(fdt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y,fd_ts,xlab=NULL,ylab=NULL, main = "Media Móvil Doble Modificado",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","MedMovD"),col=c(1,2),lty=c(1,2))
#Errores
yd_pr<-rep(0,143)
#Errores
yd_pr<-rep(0,143)
for (t in 1:143) yd_pr[t]<-f[t]
mae_yd<-MAE(y,yd_pr)
mape_yd<-MAPE(y,yd_pr)
smape_yd<-SMAPE(y,yd_pr)
mse_yd<-MSE(y,yd_pr)
rmse_yd<-RMSE(y,yd_pr)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Prom.Movil doble Modificado")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Prom.Movil doble Modificado")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
yd_pr_2 <- ts(yd_pr, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
lis_mae<-yd_pr+mae_yd
lii_mae<-yd_pr-mae_yd
lis_rmse<-yd_pr+rmse_yd
lii_rmse<-yd_pr-rmse_yd
ts.plot(yd_pr_2, lis_mae, lii_mae, lis_rmse, lii_rmse, xlab=NULL, main="Pronóstico ´Media Móvil Doble Modificado´", lty=c(1,2,2,2,2), col = c(1,6,6,3,3))
info_tda_1 <- Walmart[Walmart$Store == '1',]
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
library(fpp2)
#SIMPLE CON 0.1
est.s1<-ses(y, h = 2, level = c(99,99), initial = c("simple"),  alpha = 0.1)
fse<-est.s1$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Simple 0.1")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Simple 0.1")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#OPTIMAL 0.1
est.o1<-ses(y, h = 2, level = c(99,99), initial = c("optimal"),  alpha = 0.1)
fse<-est.o1$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Optimal 0.1")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Optimal 0.1")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#SIMPLE CON 0.5
est.s5<-ses(y, h = 2, level = c(95,95), initial = c("simple"),  alpha = 0.5)
fse<-est.s5$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Simple 0.5")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Simple 0.5")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#OPTIMAL 0.5
est.o5<-ses(y, h = 2, level = c(95,95), initial = c("optimal"),  alpha = 0.5)
fse<-est.o5$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Optimal 0.5")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Optimal 0.5")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#SIMPLE CON 0.8
est.s8<-ses(y, h = 2, level = c(92,92), initial = c("simple"),  alpha = 0.8)
fse<-est.s8$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Simple 0.8")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Simple 0.8")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
#OPTIMAL 0.8
est.o8<-ses(y, h = 2, level = c(92,92), initial = c("optimal"),  alpha = 0.8)
fse<-est.o8$fitted
fse_ts<-ts(fse,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fset_ts<-rep(0,144)
for(t in 3:144) fset_ts[t]<-fse_ts[t-2]
for(t in 1:2) fset_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fset_ts,xlab=NULL,ylab=NULL, main = "Serie Suavizada Exponencialmente",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Suavizada"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fse_ts)
mape_yd<-MAPE(y,fse_ts)
smape_yd<-SMAPE(y,fse_ts)
mse_yd<-MSE(y,fse_ts)
rmse_yd<-RMSE(y,fse_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Suavizamiento Exponencial Optimal 0.8")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Suavizamiento Exponencial Optimal 0.8")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
esth<-holt(y, h = 2, level = c(80, 95), initial = c("simple"),  alpha = NULL, beta = NULL)
fh<-esth$fitted
fh_ts<-ts(fh,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fht_ts<-rep(0,144)
for(t in 3:144) fht_ts[t]<-fh_ts[t-2]
for(t in 1:2) fht_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fht_ts,xlab=NULL,ylab=NULL, main = "Pronóstico de Holt",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Holt"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fh_ts)
mape_yd<-MAPE(y,fh_ts)
smape_yd<-SMAPE(y,fh_ts)
mse_yd<-MSE(y,fh_ts)
rmse_yd<-RMSE(y,fh_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Pronóstico de Holt")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Pronóstico de Holt")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
esth<-holt(y, h = 2, level = c(80, 95), initial = c("optimal"),  alpha = NULL, beta = NULL)
fh<-esth$fitted
fh_ts<-ts(fh,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
fht_ts<-rep(0,144)
for(t in 3:144) fht_ts[t]<-fh_ts[t-2]
for(t in 1:2) fht_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start=decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fht_ts,xlab=NULL,ylab=NULL, main = "Pronóstico de Holt",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","Holt"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_yd<-MAE(y,fh_ts)
mape_yd<-MAPE(y,fh_ts)
smape_yd<-SMAPE(y,fh_ts)
mse_yd<-MSE(y,fh_ts)
rmse_yd<-RMSE(y,fh_ts)
medidas <- matrix(c(mae_yd,mape_yd,smape_yd,mse_yd,rmse_yd)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("Pronóstico de Holt optimal")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","Pronóstico de Holt optimal")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
y <- ts(info_tda_1$Weekly_Sales, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(y)
##Modelo HOLT-WINTERS "multiplicative"
library(forcats)
est_hwm<-hw(y, h = 2, seasonal = c("multiplicative"),level = c(80, 95),initial = c("simple"), alpha = NULL, beta = NULL, gamma = NULL)
fhwm<-est_hwm$fitted
fhwm_ts<-ts(fhwm,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
fhwmt_ts<-rep(0,144)
for(t in 3:144) fhwmt_ts[t]<-fhwm_ts[t-2]
for(t in 1:2) fhwmt_ts[t]<-NA
yt<-rep(0,144)
for(t in 1:142) yt[t]<-y[t]
for(t in 143:144) yt[t]<-NA
yt_ts<-ts(yt,start = decimal_date(as.Date("2010-02-05")), frequency = 52)
ts.plot(yt_ts,fhwmt_ts,xlab=NULL,ylab=NULL, main = "Pronóstico de Holt-Winters Multiplicativo",lty=c(1:2),col=c(1,2))
legend(x="bottomright",legend=c("Obs","HoltWM"),col=c(1,2),lty=c(1,2))
#ERRORES
mae_est_hwm<-MAE(y,fhwm_ts)
mape_est_hwm<-MAPE(y,fhwm_ts)
smape_est_hwm<-SMAPE(y,fhwm_ts)
mse_est_hwm<-MSE(y,fhwm_ts)
rmse_est_hwm<-RMSE(y,fhwm_ts)
medidas <- matrix(c(mae_est_hwm,mape_est_hwm,smape_est_hwm,mse_est_hwm,rmse_est_hwm)); medidas
rownames(medidas) <- c('MAE','MAPE','SMAPE','MSE','RMSE')
colnames(medidas)<-c("HOLT-WINTERS M")
df_medidas <- as.data.frame(medidas)
tab_medidas <- as.data.table(df_medidas, keep.rownames=TRUE, keep.colnames=FALSE)
colnames(tab_medidas) <- c("Medida","HOLT-WINTERS M")
ftab_medidas <- format(tab_medidas, digits=5, scientific = F, big.mark=",",decimal.mark=".",justify="right")
tem <- ttheme_minimal(base_colour="black",base_size=15, core=list(bg_params=list(fill=blues9,col=NA)))
grid.arrange(tableGrob(ftab_medidas,theme=tem))
yd_pr_2 <- ts(fhwm_ts, start = decimal_date(as.Date("2010-02-05")), frequency = 52)
lis_mae<-fhwm_ts+mae_est_hwm
lii_mae<-fhwm_ts-mae_est_hwm
lis_rmse<-fhwm_ts+rmse_est_hwm
lii_rmse<-fhwm_ts-rmse_est_hwm
ts.plot(yd_pr_2, lis_mae, lii_mae, lis_rmse, lii_rmse, xlab=NULL, main="Pronóstico ´Holt-Winters Multiplicativo´", lty=c(1,2,2,2,2), col = c(1,6,6,3,3))
legend(x="bottomright",legend=c("Pron","LimMAEInf", "LimMAESup","LimRMSEInf","LimRMSESup"),col=c(1,2,2,2,2),lty=c(1,6,6,3,3), cex=0.8)
knitr::opts_chunk$set(echo = TRUE)
data1 = read.csv("WALMART_SALES_DATA.csv")
Walmart = read.csv("WALMART_SALES_DATA.csv")
install.packages("prettydoc")
getwd()
setwd("C:/Users/Asus/Desktop/Diplomado/3-SeriesDeTiempo/ProyectoFinal")
getwd()
